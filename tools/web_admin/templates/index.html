{% extends "base.html" %}

{% block title %}Главная - Былины MUD Админка{% endblock %}

{% block content %}
<!-- Greeting -->
<div style="margin-bottom: 2rem;">
    <h2 class="font-serif-display" style="font-size: 28px;">
        Добро пожаловать{% if username %}, <span class="text-amber-700">{{ username }}</span>{% endif %}
    </h2>
    <p class="font-inter text-ink-light" style="font-size: 16px; line-height: 1.6; margin-top: 8px;">
        Панель управления миром Былин. Выберите раздел для работы.
    </p>
</div>

<!-- World Overview -->
<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; margin-bottom: 2.5rem;">

    <!-- Zones -->
    <a href="{{ url_for('zones_list') }}" class="stat-nav-card-link">
        <div class="stat-nav-card">
            <div class="stat-nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M2 12h20M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
                </svg>
            </div>
            <div class="stat-nav-number">{{ stats.zones if stats and stats.status == 'ok' else '--' }}</div>
            <div class="stat-nav-label">Зоны</div>
            <div class="stat-nav-desc">Локации и области мира</div>
        </div>
    </a>

    <!-- Mobs -->
    <a href="{{ url_for('mobs_list', zone=1) }}" class="stat-nav-card-link">
        <div class="stat-nav-card">
            <div class="stat-nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                    <circle cx="12" cy="7" r="4"/>
                </svg>
            </div>
            <div class="stat-nav-number">{{ stats.mobs if stats and stats.status == 'ok' else '--' }}</div>
            <div class="stat-nav-label">Мобы</div>
            <div class="stat-nav-desc">NPC и обитатели мира</div>
        </div>
    </a>

    <!-- Objects -->
    <a href="{{ url_for('objects_list', zone=1) }}" class="stat-nav-card-link">
        <div class="stat-nav-card">
            <div class="stat-nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
                    <polyline points="3.27 6.96 12 12.01 20.73 6.96"/>
                    <line x1="12" y1="22.08" x2="12" y2="12"/>
                </svg>
            </div>
            <div class="stat-nav-number">{{ stats.objects if stats and stats.status == 'ok' else '--' }}</div>
            <div class="stat-nav-label">Предметы</div>
            <div class="stat-nav-desc">Экипировка и инвентарь</div>
        </div>
    </a>

    <!-- Rooms -->
    <a href="{{ url_for('rooms_list', zone=1) }}" class="stat-nav-card-link">
        <div class="stat-nav-card">
            <div class="stat-nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                    <polyline points="9 22 9 12 15 12 15 22"/>
                </svg>
            </div>
            <div class="stat-nav-number">{{ stats.rooms if stats and stats.status == 'ok' else '--' }}</div>
            <div class="stat-nav-label">Комнаты</div>
            <div class="stat-nav-desc">Локации и описания</div>
        </div>
    </a>

    <!-- Triggers -->
    <a href="{{ url_for('triggers_list', zone=1) }}" class="stat-nav-card-link">
        <div class="stat-nav-card">
            <div class="stat-nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>
                </svg>
            </div>
            <div class="stat-nav-number">{{ stats.triggers if stats and stats.status == 'ok' else '--' }}</div>
            <div class="stat-nav-label">Триггеры</div>
            <div class="stat-nav-desc">DG-скрипты и события</div>
        </div>
    </a>

</div>

<!-- Online Players -->
{% if players and players.status == 'ok' %}
<div style="margin-bottom: 2.5rem;">
    <h3 class="font-serif-display" style="font-size: 20px; margin-bottom: 1rem; color: #78350f;">
        Игроки онлайн
        <span style="font-size: 14px; font-weight: normal; color: #92400e; margin-left: 8px;">({{ players.count }})</span>
    </h3>

    {% if players.players|length > 0 %}
    <div class="parchment-card" style="padding: 0;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 2px solid #e7dac3;">
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #78350f;">Имя</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #78350f;">Уровень</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #78350f;">Реморт</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #78350f;">Класс</th>
                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #78350f;">Комната</th>
                </tr>
            </thead>
            <tbody>
                {% for player in players.players %}
                <tr style="border-bottom: 1px solid #f3eed9;">
                    <td style="padding: 12px;">
                        <span class="font-inter" style="color: {% if player.is_immortal %}#dc2626{% else %}#1f2937{% endif %};">
                            {{ player.name }}
                            {% if player.is_immortal %}<span style="color: #dc2626; font-size: 12px; margin-left: 4px;">[Имм]</span>{% endif %}
                        </span>
                    </td>
                    <td style="padding: 12px; color: #4b5563;">{{ player.level }}</td>
                    <td style="padding: 12px; color: #4b5563;">{{ player.remort }}</td>
                    <td style="padding: 12px; color: #4b5563;">{{ player.class }}</td>
                    <td style="padding: 12px; color: #4b5563;">#{{ player.room }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="parchment-card" style="padding: 20px; text-align: center; color: #92400e;">
        Нет игроков онлайн
    </div>
    {% endif %}
</div>
{% endif %}

<!-- Warning Banner -->
<div class="msg-warning">
    <div style="flex-shrink: 0; margin-top: 2px;">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#b45309" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
            <line x1="12" y1="9" x2="12" y2="13"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
        </svg>
    </div>
    <div>
        <div class="msg-title">Внимание: работа с живыми данными</div>
        <div class="msg-text">Все изменения, сделанные через эту панель, применяются непосредственно к работающему серверу. Будьте внимательны при редактировании.</div>
    </div>
</div>

{% endblock %}
